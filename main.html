<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru">
   <head>
      <title>Photo database</title>
      <meta http-equiv="content-type" content="text/html; charset=utf-8" />
      <script src="jquery/jquery-1.5.2.min.js" type="text/javascript"></script>
      <style type="text/css">
         #result {
            float: left;
            width: 500px;
            height: 200px;
            padding: 10px;
            margin: 10px;
            border: 1px solid #369;
            display: inline-block;
         }
      </style>
      <script type="text/javascript">
         $(function() {
            var form = document.forms.upload,
                result = $('#result');
            form.onsubmit = function() {
               var file = this.elements.file1.files[0];
               if (file) upload(file, function() {
                  result.html('Передача файла прошла успешна!');
               }, function() {
                  result.html('Ошибка! Передача файла не удалась!');
               }, function(loaded, total) {
                  result.html('Передано ' + loaded + ' из ' + total);
               });
               return false;
            }

            function upload(file, onSuccess, onError, onProgress) {
               var xhr = new XMLHttpRequest();
               xhr.onload = xhr.onerror = function() {
                  if(this.status != 200 || this.responseText != 'OK') {
                     onError(this);
                     return;
                  }
                  onSuccess();
               };
               xhr.upload.onprogress = function(event) {
                  onProgress(event.loaded, event.total);
               }
               xhr.open("POST", "upload.php", true);
               xhr.send(file);
            }
         });
      </script>
   </head>
   <body>
      <div id="result"></div>
      <!--<button id="send">Получить фотографию</button>-->

      <form name="upload">
         <input type="hidden" name="MAX_FILE_SIZE" value="5242880">
         <input name="userfile" type="file" name="file1">
         <input type="submit" value="Загрузить">
      </form>


      <!--<form enctype="multipart/form-data" action="/upload.php" method="post">
         <input type="hidden" name="MAX_FILE_SIZE" value="5242880">
         <input name="userfile" type="file">
         <br/>
         <input type="submit" value="Сохранить изображение">
      </form>-->
   </body>
</html>
